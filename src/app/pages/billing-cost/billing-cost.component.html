<div class="container my-4">
  <h3 class="mb-3">Monthly Billing</h3>

  <form [formGroup]="billingForm">

    <!-- Flats FormArray -->
    <div formArrayName="flats">
      <div
        class="card p-3 mb-4"
        *ngFor="let flat of flats.controls; let i = index"
        [formGroupName]="i"
      >
        <h5 class="mb-3">Flat {{ flat.value.flatId }} â€” {{ flat.value.tenantName }}</h5>

        <!-- ðŸ”¹ Billing Info -->
        <div class="row g-3 mb-3">
          <div class="col-md-4">
            <label>Billing Type</label>
            <select formControlName="billingType" class="form-select">
              <option value="advance">Advance</option>
              <option value="one-month">One Month Completion</option>
            </select>
          </div>

        

          <div class="col-md-4">
            <label>Pay Date</label>
            <input type="date" class="form-control" formControlName="payDate" />
          </div>
        </div>

        <!-- ðŸ”¹ Rent + Services + Electricity -->
        <!-- ðŸ”‹ Electricity Row -->
<ng-container *ngIf="flat.value.servicesUsed?.electricity">
  <div class="row g-3">
    <div class="col-md-4">
      <label>Previous Unit</label>
      <input type="number" class="form-control" formControlName="previousUnit" />
    </div>
    <div class="col-md-4">
      <label>Current Unit</label>
      <input type="number" class="form-control" formControlName="currentUnit" />
    </div>
    <div class="col-md-4">
      <label>Electricity Cost (â‚¹)</label>
      <input class="form-control" formControlName="electricityCost" />
    </div>
  </div>
</ng-container>

<!-- ðŸ’¸ Rent & Services Row -->
<div class="row g-3 mt-2">
  <div class="col-md-4">
    <label>Rent</label>
    <input class="form-control" formControlName="rentAmount" />
  </div>

  <ng-container *ngIf="flat.value.servicesUsed?.parking">
    <div class="col-md-4">
      <label>Parking (â‚¹)</label>
      <input type="number" class="form-control" formControlName="parking" />
    </div>
  </ng-container>

  <ng-container *ngIf="flat.value.servicesUsed?.wifi">
    <div class="col-md-4">
      <label>Wifi (â‚¹)</label>
      <input type="number" class="form-control" formControlName="wifi" />
    </div>
  </ng-container>

  <ng-container *ngIf="flat.value.servicesUsed?.maintenance">
    <div class="col-md-4">
      <label>Maintenance (â‚¹)</label>
      <input type="number" class="form-control" formControlName="maintenance" />
    </div>
  </ng-container>

  <ng-container *ngIf="flat.value.servicesUsed?.water">
    <div class="col-md-4">
      <label>Water (â‚¹)</label>
      <input type="number" class="form-control" formControlName="water" />
    </div>
  </ng-container>

  <div class="col-md-4 mt-2">
    <label>Total Amount (â‚¹)</label>
    <input class="form-control fw-bold text-success" formControlName="total" />
  </div>
</div>

      </div>
    </div>
  </form>
</div>
